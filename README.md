# è“å±±Webå¯’å‡åŒäººè€ƒæ ¸-çŸ¥ä¹

### æ¥å£æ–‡æ¡£ğŸ“ƒ

[è“å±±çŸ¥ä¹æ¥å£](https://console-docs.apipost.cn/preview/648a7969b340d643/bd974949c5b66514)

------

å‰ç«¯éƒ¨ç½²åœ°å€ https://zhihu.madeindz.work/

åç«¯éƒ¨ç½²åœ°å€ https://gogo.madeindz.work/

------
å‰ç«¯-æ½˜éº’éºŸ-githubä»“åº“:https://github.com/xiyueyezibile/lanshanzhihu/tree/master/zhihu

åç«¯-é‚“å“-githubä»“åº“:https://github.com/Nihilism0/LanShan-zhihu

------
## å‰è¨€ğŸ˜†

å’Œå‰ç«¯åŒå­¦ä¸€èµ·èŠ±äº†ä¸å°‘æ—¶é—´å®Œæˆçš„è¿™ä¸ªé¡¹ç›®ï¼Œè™½ç„¶è¿˜æ˜¯æœ‰è®¸å¤šä¸è¶³çš„åœ°æ–¹ï¼Œä½†è¿˜æ˜¯æœ‰æˆ‘ä»¬è‡ªå·±çš„åŠªåŠ›åœ¨é‡Œé¢ã€‚æ–‡æ¡£ä¸­æœ‰ä¸€äº›åŠŸèƒ½çš„è¯´æ˜ï¼Œå¸Œæœ›å­¦é•¿ä»¬å¯ä»¥çœ‹çœ‹ã€‚ğŸ¥°

## **æŠ€æœ¯æ ˆ**ğŸ’«

æ¡†æ¶:**Gin**

è®¤è¯:**JWT**

é˜²è·¨åŸŸ:**Cors**

æ–°åè®®:**Websocket**

æ¶ˆæ¯é˜Ÿåˆ—:**NSQ**

å¤–æ¥ä¸šåŠ¡:**è…¾è®¯äº‘SMS**

é…ç½®ç®¡ç†:**Viper**

é™æµ:**ä»¤ç‰Œæ¡¶/jujuåŒ…**

æ—¥å¿—åº“:**Zap**

æ•°æ®åº“:**Mysql Redis**

## å·²å®ç°åŠŸèƒ½åˆ—è¡¨â›³

*ç²—ä½“ä¸ºåŸºç¡€åŠŸèƒ½è¦æ±‚*

- **ç”¨æˆ·æ³¨å†Œ**
- **ç”¨æˆ·ç™»å½•**
- **å‘å¸ƒé—®é¢˜**
- **å›ç­”é—®é¢˜**
- **å‘å¸ƒæ–‡ç« **
- **è¯„è®ºå›ç­”å’Œè¯„è®ºæ–‡ç« **
- **æˆ‘çš„ï¼ˆä¸ªäººä¿¡æ¯æ ï¼‰**
- **ç”¨æˆ·ä¿¡æ¯æ›´æ”¹ï¼ˆæ˜µç§°ï¼Œå¯†ç , æ€§åˆ« ,ç­¾å ç­‰ï¼‰**
- **æˆ‘çš„æ”¶è—(æ”¶è—å¤¹)**
- çƒ­æ¦œ
- ç”¨æˆ·å¯†ç åŠ ç›åŠ å¯†(Md5)
- ç”¨æˆ·ç™»å½•æœ‰çŸ­ä¿¡ç™»å½•ã€é‚®ç®±ç™»å½•ã€æ‰‹æœºç™»å½•
- éªŒè¯ç ï¼ˆç™»å½•ï¼Œæ³¨å†Œï¼Œä¿®æ”¹å¯†ç ï¼‰
- ç”¨æˆ·çŠ¶æ€ä¿å­˜ä½¿ç”¨ JWT
- æœç´¢åŠŸèƒ½ï¼ˆæœç´¢é—®é¢˜æˆ–æ–‡ç« ï¼‰
- ç‚¹èµåŠŸèƒ½ï¼ˆèµåŒé—®é¢˜ã€æ–‡ç« ã€è¯„è®ºï¼‰
- å…³æ³¨åŠŸèƒ½ï¼ˆå…³æ³¨çš„äººæé—®ï¼Œå›ç­”ï¼Œç‚¹èµä¼šå¾—åˆ°é€šçŸ¥ï¼‰
- ç›é€‰ä¼šå‘˜ï¼ˆåªæœ‰æ°ªé‡‘æ‰èƒ½çœ‹å®Œæ•´çš„çŸ¥ä¹æ–‡ç« ï¼‰
- ç”¨æˆ·æµè§ˆè®°å½•
- å°†é¡¹ç›®éƒ¨ç½²ä¸Šçº¿ï¼ˆåŒ…æ‹¬å‰ç«¯å’Œåç«¯çš„é¡¹ç›®ï¼Œä¹Ÿå°±æ˜¯ç™»å½•ä½ çš„ç½‘ç«™èƒ½å¤Ÿåƒæ­£å¸¸çš„ç½‘ç«™ä¸€æ ·è®¿é—®ï¼‰
- ä½¿ç”¨ https åŠ å¯†
- ç§ä¿¡èŠå¤©
- å•†åŸ(ç›é€‰ä¼šå‘˜è·å–æ¸ é“)
- é™æµ(ä»¤ç‰Œæ¡¶)

## äº®ç‚¹âœ¨

### çŸ­ä¿¡ä¸šåŠ¡ğŸ’Œ																																																																													

å¤–æ¥**è…¾è®¯äº‘SMSçŸ­ä¿¡ä¸šåŠ¡**,é€šè¿‡éšæœºç”Ÿæˆå…­ä½æ•°çš„å‡½æ•°è·å¾—éªŒè¯ç ä¿¡æ¯, å‘é€è‡³ç”¨æˆ·çš„æ‰‹æœºå¹¶Setè¿›Redisæ•°æ®åº“, å¹¶è®¾ç½®TTLä¸º3åˆ†é’Ÿ, åœ¨éœ€è¦éªŒè¯æ—¶Getå¹¶æ ¡å¯¹.

æ­¤çŸ­ä¿¡ä¸šåŠ¡åœ¨ç™»å½•ç³»ç»Ÿ, æ³¨å†Œç³»ç»Ÿ, ä¿®æ”¹å¯†ç æ—¶ä¼šç”¨åˆ°.

![image](https://user-images.githubusercontent.com/114405451/212082265-3d3cc9e0-679b-4040-8267-3c46faef6821.png)
![image](https://user-images.githubusercontent.com/114405451/212084801-f9566333-7395-404d-b9f0-c3644acb5384.png)

### NSQ+WebsocketğŸ“¨

ä½¿ç”¨NSQè¿›è¡Œåšæ¶ˆæ¯é˜Ÿåˆ—,æ¶ˆæ¯é˜Ÿåˆ—æŠŠä¸šåŠ¡æµç¨‹ä¸­çš„éå…³é”®æµç¨‹å¼‚æ­¥åŒ–ï¼Œä»è€Œæ˜¾è‘—é™ä½ä¸šåŠ¡è¯·æ±‚çš„å“åº”æ—¶é—´

ä½¿ç”¨å¸¦çŠ¶æ€çš„åè®®websocketè®©æœåŠ¡å™¨ä¸»åŠ¨æ¨é€æ¶ˆæ¯

![image](https://user-images.githubusercontent.com/114405451/212082327-85f20124-3561-49b1-8e44-963bbeaf1676.png)

ç”Ÿäº§è€…(å…³æ³¨çš„äººæœ‰åŠ¨ä½œä¾¿è¿›è¡Œ)

![image](https://user-images.githubusercontent.com/114405451/212082732-9bc3c0d7-8ac8-440f-abc6-1665a54fe22d.png)

æ¶ˆè´¹è€…(mainå‡½æ•°ä¸­èµ·çº¿ç¨‹,ç›‘å¬nsqç®¡é“)

![image](https://user-images.githubusercontent.com/114405451/212082763-7391cff5-6d88-4516-9f16-69f6f6e4ffa1.png)

é€šè¿‡ç”¨æˆ·æ˜¯å¦è¿æ¥websocketåˆ¤æ–­readæ˜¯0(æœªè¯»)è¿˜æ˜¯1(å·²è¯»)

![image](https://user-images.githubusercontent.com/114405451/212082804-a27c0b84-d40c-4e17-93e7-1233240e4061.png)

è‹¥åœ¨çº¿ä¼šè¿›è¡Œå³æ—¶æ¨é€,å¹¶æŠŠæ¶ˆæ¯readè®¾ç½®ä¸º1

![image](https://user-images.githubusercontent.com/114405451/212082854-b15b90a4-b896-4d70-98c1-be45aaf5028d.png)

ç”¨æˆ·è‹¥ç‚¹è¿›å…³æ³¨é“ƒé“›æŒ‰é’®,çœ‹è§æœªè¯»ä¿¡æ¯å¹¶è‡ªåŠ¨å°†å…¶è®¾ç½®ä¸º1

### HOTå€¼æ¯”é‡ğŸ”¥

çƒ­æ¦œä¾‹å¦‚å›ç­”çš„**HOT**å€¼ç”±ç‚¹èµæ•°å’Œè¯„è®ºæ•°é€šè¿‡ä¸€å®šæ¯”é‡ç›¸åŠ æ’åˆ—è€Œæˆ,ä¸ä»…ä»…åªç”±å•ä¸€æŒ‡æ ‡å†³å®š

![image](https://user-images.githubusercontent.com/114405451/212082894-9515b2fc-f7b1-4e43-8d16-3f4f083530cb.png)

### æ”¶è—å¤¹åŠå…¶éšç§ğŸ—ƒï¸

ç”¨æˆ·æ”¶è—å¯ä»¥è®¾ç½®**æ”¶è—å¤¹**, ä½¿ç”¨å¤–é”®çº¦æŸçš„æ–¹å¼å…³è” æ”¶è—å®ä¾‹è¡¨.

æ¯ä¸ªæ”¶è—å¤¹éƒ½è®¾è®¡äº†Privateéšç§é€‰é¡¹,1ä¸ºéšç§,0ä¸ºå…¬å¼€(é»˜è®¤).

ç”¨æˆ·éšæ—¶å¯ä»¥æ›´æ”¹æ”¶è—å¤¹åå’Œå…¶éšç§æ€§å’Œæè¿°,ä¹Ÿä¼šè¿›è¡Œé€»è¾‘ä¸Šçš„æ”¶è—å¤¹é‡åæ£€æŸ¥

![image](https://user-images.githubusercontent.com/114405451/212082982-36d38534-a6e0-41b9-8d2b-b5c8e945a257.png)

### WebSocketèŠå¤©ğŸ‘©ğŸ¼â€â¤ï¸â€ğŸ‘¨ğŸ»

è®¾ç½®**é˜²éªšæ‰°æ¨¡å¼**: è‹¥å•æ–¹é¢å‘é€æ¶ˆæ¯ä¸‰æ¡ä»¥ä¸Šä¾¿é™åˆ¶å…¶å‘é€,

å†å²æ¡æ•°é€šè¿‡Rediså‚¨å­˜,æ¶ˆæ¯å®ä¾‹é€šè¿‡MySqlå‚¨å­˜

![image](https://user-images.githubusercontent.com/114405451/212083020-5d175192-1a07-4d25-a8d0-5ca9d70abb2f.png)

åˆ¤æ–­å¯¹æ–¹æ˜¯å¦åœ¨çº¿,åŸç†æ˜¯åœ¨æ€»çš„Clientsç®¡ç†ç»“æ„ä½“ä¸­æŸ¥æ‰¾IDæ˜¯å¦æœ‰SendID,ä»¥æ­¤æ¥å†³å®šä¿¡æ¯

![image](https://user-images.githubusercontent.com/114405451/212083065-d9f2779f-9f28-4a7d-bccd-48486305e7c4.png)

### **å•†åŸ**ğŸª

ç”¨æˆ·æ‹¥æœ‰**GOå¸**ğŸª™(è·å¾—GOå¸çš„æ¸ é“æ˜¯å‘å¸ƒé—®é¢˜+3,å›ç­”+5,æ–‡ç« +5,è¯„è®º+1),å¯ä»¥åœ¨å•†åŸè´­ä¹°VIPç­‰

æ¯ä»¶å•†å“æœ‰æè¿°å’Œé”€é‡

![image](https://user-images.githubusercontent.com/114405451/212083145-0ed33609-4b43-4a56-9748-952cdf909d64.png)

æœ‰shoplistè¡¨,å¯ä»¥æŸ¥çœ‹ç”¨æˆ·çš„è´­ä¹°å†å²,ç”¨ä½œç”¨æˆ·æŸ¥è¯¢å’Œdaoå±‚é€»è¾‘åˆ¤æ–­

![image](https://user-images.githubusercontent.com/114405451/212083167-c1edec72-76c7-4f26-82ef-9dde12909ea5.png)

### ä»¤ç‰Œæ¡¶é™æµğŸª£

ä½¿ç”¨ä»¤ç‰Œæ¡¶é™æµç­–ç•¥ ,é™åˆ¶è¯·æ±‚æ•°é‡, å–ä»¤ç‰Œé›†ä¸­åœ¨å‘å¸ƒé—®é¢˜æ–‡ç« ç­‰åœ°æ–¹,é˜²æ­¢è¯·æ±‚è¿‡å¤§ç»™æˆ‘æœåŠ¡å™¨å¹²çƒ‚, åŠ å¼ºæœåŠ¡çš„ç¨³å®šæ€§

![image](https://user-images.githubusercontent.com/114405451/212083204-6f586210-064b-4a55-a31c-35490b58e6d9.png)

![image](https://user-images.githubusercontent.com/114405451/212083226-070bbcfe-3d2b-4aab-95f6-d5d56ab5352e.png)

## éš¾ç‚¹ä¸æ”¶è·ğŸ˜¿

è¿™äº›éš¾ç‚¹æœ‰äº›æ˜¯å› ä¸ºå®ƒå°±æ˜¯å¾ˆéš¾,æœ‰äº›æ˜¯å› ä¸ºçŸ¥è¯†å±‚é¢ä¸å¤Ÿæ‰éš¾,çŸ¥é“äº†åä¾¿ä¸ç®—éš¾ç‚¹,æˆ‘é‡åˆ°çš„å¤§å¤šä¸ºåè€…

### NSQ+Websocket

ä½¿ç”¨websocketè¿™ä¸ªåˆå­¦é™Œç”Ÿçš„åè®®æ¥ç›‘å¬æ˜¯å¦å‘é€ä¿¡æ¯ç­‰,è¿ç”¨ç®¡é“å’Œgoroutine

ç¬¬ä¸€æ¬¡æ¥è§¦,æ„Ÿè§‰æ¯”è¾ƒéš¾

### http / https

ä½¿ç”¨httpsåŠ å¯†éœ€è¦çš„SSLè¯ä¹¦å¿…é¡»æ¶µç›–æ­¤ç½‘ç«™,è€Œä¸”ç«¯å£ä¸º80æˆ–è€…**443**æ‰æ˜¯å®‰å…¨ç«¯å£,å†…éƒ¨è‡ªå·±è®¾ç½®çš„ç«¯å£ä¼šåˆ¤æ–­ä¸ºä¸å®‰å…¨

### CORSè·¨åŸŸé—®é¢˜

å‰ç«¯ä¸æˆ‘å¯¹æ¥æ—¶å‘ç”Ÿäº†è·¨åŸŸé—®é¢˜,æŠ˜è…¾å¾ˆä¹…å‘ç°æ˜¯å‰ç«¯å‘é€è¯·æ±‚ä¼šæœ‰ä¸¤æ¬¡,ç¬¬ä¸€æ¬¡æ˜¯OPTIONSè¯·æ±‚å®šä½æœåŠ¡å™¨,ç¬¬äºŒæ¬¡æ˜¯çœŸæ­£çš„è¯·æ±‚,æ‰€ä»¥CORSå°±è¦æœ‰ä¸€ä¸ªé€»è¾‘,å½“Requestæ˜¯OPTIONSæ–¹æ³•å°±è¦ç»™å…¶200,æ‰ä¸ä¼šæŠ¥é”™

![image](https://user-images.githubusercontent.com/114405451/212083284-3ae09f4c-1710-4219-89ba-ae8d24d0e86f.png)

### MySqlè®¾ç½®é—®é¢˜

ä½¿ç”¨gormè¿›è¡Œå¤–é”®çº¦æŸå,å…¶é»˜è®¤åˆ é™¤å’Œæ”¹å˜ä¸»é”®çš„æ¨¡å¼éƒ½æ˜¯RESTRICT,è¿™ä¸å¥½,å½“è¦åˆ é™¤ä¸»é”®æ‰€åœ¨è¡¨çš„æ•°æ®,ä¼šè¢«å¤–é”®çº¦æŸæŠ¥é”™,è€Œå¯ä»¥æŠŠè¿™ä¸ªæ¨¡å¼æ”¹ä¸ºCASCADE,å½“ä¸»é”®è¢«æ”¹æ—¶å…¶å¤–é”®ä¹Ÿä¸€æ ·è¢«æ”¹,ä¸»é”®åˆ é™¤åå¤–é”®ä¹Ÿåˆ é™¤. ç”¨æˆ·è¿›è¡Œæ”¹åæ“ä½œæ—¶ååˆ†æœ‰ç”¨,ä¸éœ€è¦æ‰€æœ‰çš„è¡¨éƒ½å»update username

![image](https://user-images.githubusercontent.com/114405451/212083309-11f7d41b-e815-42e6-989c-feb0ade36154.png)


## Redisç¼“å­˜è®¾è®¡

ç‚¹èµ


![image](https://user-images.githubusercontent.com/114405451/212883685-e3ee3138-fca3-4904-a8e5-cc21926fbd30.png)


![image](https://user-images.githubusercontent.com/114405451/212883799-b7dcb8d9-8480-43a0-9929-52f7551304b8.png)

çŸ­ä¿¡å°±æ˜¯å¾ˆç®€å•æ˜¯set get


